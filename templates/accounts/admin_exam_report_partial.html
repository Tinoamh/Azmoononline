<div style="direction: rtl; text-align: right;">
    <h3 style="color: #3b82f6; font-weight: 800; margin-bottom: 5px;">{{ exam.name }}</h3>
    <p style="color: #64748b; font-size: 14px; margin-bottom: 20px;">استاد: {{ exam.created_by.first_name }} {{ exam.created_by.last_name }}</p>

    <h4 style="font-weight: 700; margin-bottom: 15px;">نتایج دانش‌آموزان</h4>
    
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="background: #f1f5f9; color: #475569;">
                <th style="padding: 10px; border-bottom: 2px solid #e2e8f0; text-align: center;">رتبه</th>
                <th style="padding: 10px; border-bottom: 2px solid #e2e8f0; text-align: right;">نام دانش‌آموز</th>
                <th style="padding: 10px; border-bottom: 2px solid #e2e8f0; text-align: center;">درصد</th>
                <th style="padding: 10px; border-bottom: 2px solid #e2e8f0; text-align: center;">نمره (از ۲۰)</th>
            </tr>
        </thead>
        <tbody>
            {% for r in results %}
            <tr style="border-bottom: 1px solid #f8fafc;">
                <td style="padding: 12px; text-align: center; font-weight: bold;">{{ r.rank }}</td>
                <td style="padding: 12px;">{{ r.student_name }}</td>
                <td style="padding: 12px; text-align: center; color: #3b82f6;">{{ r.score_percent }}%</td>
                <td style="padding: 12px; text-align: center;">{{ r.score_20 }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="padding: 20px; text-align: center; color: #94a3b8;">هنوز هیچ دانش‌آموزی در این آزمون شرکت نکرده است.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div style="height: 24px;"></div>

    <h4 style="font-weight: 700; margin-bottom: 15px;">تحلیل جامع آزمون</h4>
    <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; margin-bottom:20px;">
      <div style="background:#1e3a8a; color:#fff; border-radius:12px; padding:16px; text-align:center;">
        <div style="font-size:12px; opacity:0.9;">میانگین (از ۲۰)</div>
        <div style="font-size:24px; font-weight:800;">{{ avg_score_20 }}</div>
      </div>
      <div style="background:#312e81; color:#fff; border-radius:12px; padding:16px; text-align:center;">
        <div style="font-size:12px; opacity:0.9;">میانه</div>
        <div style="font-size:24px; font-weight:800;">{{ median_20 }}</div>
      </div>
      <div style="background:#4c1d95; color:#fff; border-radius:12px; padding:16px; text-align:center;">
        <div style="font-size:12px; opacity:0.9;">بیشینه</div>
        <div style="font-size:24px; font-weight:800;">{{ max_score_20 }}</div>
      </div>
      <div style="background:#1f2937; color:#fff; border-radius:12px; padding:16px; text-align:center;">
        <div style="font-size:12px; opacity:0.9;">شرکت‌کنندگان</div>
        <div style="font-size:24px; font-weight:800;">{{ participants_count }}</div>
      </div>
    </div>
</div>
