<!DOCTYPE html>
<html lang="fa">
<head>
  {% load static %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}سامانه آزمون آنلاین{% endblock %}</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'styles.css' %}" />
  <style>
    .hamburger{position:fixed;top:22px;right:22px;width:40px;height:32px;display:flex;flex-direction:column;justify-content:center;gap:6px;cursor:pointer;z-index:1100}
    .hamburger .bar{height:3px;background:#3A6CF4;border-radius:3px}
    .drawer-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.25);display:none;z-index:1090}
    .drawer-backdrop.open{display:block}
    .admin-drawer{position:fixed;top:0;right:0;height:100vh;width:280px;background:#3A6CF4;color:#fff;box-shadow:-12px 0 28px rgba(0,0,0,0.18);transform:translateX(100%);transition:transform .25s ease;z-index:1110;direction:rtl;display:flex;flex-direction:column}
    .admin-drawer.open{transform:translateX(0)}
    .admin-drawer-header{padding:16px 18px;border-bottom:1px solid rgba(255,255,255,0.25);font-weight:800;text-align:right}
    .admin-drawer-header a{color:#fff;text-decoration:none;display:block}
    .admin-drawer-list{list-style:none;margin:8px 0 0 0;padding:0}
    .admin-drawer-list li{margin:0;border-top:1px solid rgba(255,255,255,0.2)}
    .admin-drawer-list a{display:flex;align-items:center;justify-content:flex-start;gap:12px;padding:12px 18px;color:#fff;text-decoration:none}
    .site-footer.student-footer{background:#e2fdff}
    /* Student theme global overrides */
    body.student-theme {
      background: linear-gradient(to bottom, #c7f0ff, #fdf6ff) !important;
      min-height: 100vh;
    }
    body.student-theme .admin-drawer {
      background: #ffe0f0 !important;
      color: #333 !important;
    }
    body.student-theme .admin-drawer a {
      color: #333 !important;
    }
    body.student-theme .admin-drawer-header {
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }
    body.student-theme .admin-drawer-list li {
      border-top: 1px solid rgba(0,0,0,0.1);
    }
    body.student-theme .admin-drawer-list a:hover {
      background: rgba(0,0,0,0.05);
    }
    body.student-theme .hamburger .bar {
      background: #3F59CF; /* ensure contrast on student pages if needed, though header usually has its own bg */
    }
    /* Logo Styles */
    .fixed-logo { position: fixed; top: 22px; left: 22px; z-index: 1100; display: flex; align-items: center; gap: 12px; }
    .fixed-logo .logo-text { font-weight: 800; font-size: 24px; color: #3A6CF4; text-shadow: 0 0 10px rgba(255,255,255,0.8); }
  </style>
  {% block extra_css %}{% endblock %}
</head>
<body class="{% if user.is_authenticated and user.role and user.role.code == 'student' %}student-theme{% endif %} {% block body_class %}{% endblock %}">
  {% block header %}
  <header>
    <nav>
      {% if not user.is_authenticated %}
        <a href="/accounts/login/">ورود</a>
        <a href="/accounts/register/">ثبت‌نام</a>
      {% endif %}
    </nav>
    {% if user.is_authenticated %}
      <div id="globalHamburger" class="hamburger" aria-label="menu">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
      <div id="globalDrawerBackdrop" class="drawer-backdrop"></div>
      <nav id="globalDrawer" class="admin-drawer" aria-label="menu">
        <div class="admin-drawer-header"><a href="/accounts/profile/">{{ user.get_full_name|default:user.email }}</a></div>
        <ul class="admin-drawer-list">
          <li>
            <a href="/">
              <span class="ico">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 3l9 8h-3v8H6v-8H3l9-8z"/></svg>
              </span>
              <span class="label">خانه</span>
            </a>
          </li>
          {% if user.role and user.role.code == 'admin' %}
            <li>
              <a href="/accounts/users/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M16 11a4 4 0 10-8 0 4 4 0 008 0zm-6 5a6 6 0 00-6 6h16a6 6 0 00-6-6H10z"/></svg>
                </span>
                <span class="label">لیست کاربران</span>
              </a>
            </li>
            <li>
              <a href="/accounts/admin/classes/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M4 6h16v12H4V6zm2 2v8h12V8H6z"/></svg>
                </span>
                <span class="label">لیست کلاس‌ها</span>
              </a>
            </li>
            <li>
              <a href="/accounts/admin/exams/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                </span>
                <span class="label">لیست آزمون‌ها</span>
              </a>
            </li>
          {% elif user.role and user.role.code == 'student' %}
            <li>
              <a href="{% url 'exam_list' %}">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                </span>
                <span class="label">لیست آزمون‌ها</span>
              </a>
            </li>
            <li>
              <a href="/accounts/my-classes/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M4 6h16v12H4V6zm2 2v8h12V8H6z"/></svg>
                </span>
                <span class="label">لیست کلاس‌ها</span>
              </a>
            </li>
            <li>
              <a href="{% url 'student_scores' %}">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M5 4h14v16H5V4zm2 2v12h10V6H7zm1 1h8v2H8V7zm0 3h8v2H8v-2zm0 3h8v2H8v-2z"/></svg>
                </span>
                <span class="label">لیست نمرات</span>
              </a>
            </li>
          {% elif user.role and user.role.code == 'instructor' %}
            <li>
              <a href="/accounts/question-bank/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M5 4h14v16H5V4zm2 2v12h10V6H7zm1 1h8v2H8V7zm0 3h8v2H8v-2zm0 3h8v2H8v-2z"/></svg>
                </span>
                <span class="label">بانک سوالات</span>
              </a>
            </li>
            <li>
              <a href="/accounts/instructor/results/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                </span>
                <span class="label">نتایج آزمون‌ها</span>
              </a>
            </li>
            <li>
              <a href="/accounts/students/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M16 11a4 4 0 10-8 0 4 4 0 008 0zm-6 5a6 6 0 00-6 6h16a6 6 0 00-6-6H10z"/></svg>
                </span>
                <span class="label">لیست دانشجویان</span>
              </a>
            </li>
            <li>
              <a href="/accounts/exam-define/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M4 5h16v2H4V5zm0 6h16v2H4v-2zm0 6h16v2H4v-2z"/></svg>
                </span>
                <span class="label">تعریف آزمون</span>
              </a>
            </li>
            <li>
              <a href="/accounts/exams/">
                <span class="ico">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M5 4h14v16H5V4zm2 2v12h10V6H7zm1 1h8v2H8V7zm0 3h8v2H8v-2zm0 3h8v2H8v-2z"/></svg>
                </span>
                <span class="label">لیست آزمون‌های فعال</span>
              </a>
            </li>
          {% endif %}
          <li>
            <a href="/accounts/logout/">
              <span class="ico">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M10 3h4v2h-4V3zm1 4h2v10h-2V7zm-6 6h4v2H5v-2zm10 0h4v2h-4v-2z"/></svg>
              </span>
              <span class="label">خروج</span>
            </a>
          </li>
        </ul>
      </nav>
      <script>
        (function(){
          var b=document.getElementById('globalHamburger');
          var d=document.getElementById('globalDrawer');
          var k=document.getElementById('globalDrawerBackdrop');
          if(b&&d&&k){
            var t=function(){ d.classList.toggle('open'); k.classList.toggle('open'); };
            b.addEventListener('click', t);
            k.addEventListener('click', t);
            document.addEventListener('keydown', function(e){ if(e.key==='Escape'&&d.classList.contains('open')) t(); });
          }
        })();
      </script>
    {% endif %}
  </header>
  {% endblock %}
  <main>
    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    {% block content %}{% endblock %}
  </main>
  {% block footer %}{% endblock %}
</body>
</html>
